<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Brian's Editor</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js" type="text/javascript"></script>
  </head>
  <body>
    <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js" type="text/javascript"></script>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/dayjs@^1.7.5/dayjs.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="previews.js" type="text/babel"></script>
    <h1 id="totalPrice">Loading...</h1>
    <script>
      fetch('/data/products')
        .then(response => response.json())
        .then(products => {
          const totalPrice = products
            .filter(product => product.extension === 'yml')
            .reduce((sum, product) => sum + product.data.price, 0);
          document.getElementById('totalPrice').textContent = 'Current price of all products: Â£' + totalPrice.toFixed(2);
        })
        .catch(error => console.error('Error fetching product prices:', error));
    </script>
    <script>
      CMS.registerPreviewStyle('/stylesheets/all.css');
    </script>
  </body>
</html>
